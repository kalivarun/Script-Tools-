# Download and use NirSoft's BrowserPassView (most reliable method)
Write-Host "Downloading NirSoft BrowserPassView..." -ForegroundColor Yellow

$downloadUrl = "https://www.nirsoft.net/toolsdownload/browserpassview.zip"
$zipPath = ".\browserpassview.zip"
$extractPath = ".\browserpassview"

try {
    # Download BrowserPassView
    Invoke-WebRequest -Uri $downloadUrl -OutFile $zipPath -UseBasicParsing
    
    # Extract
    Expand-Archive -Path $zipPath -DestinationPath $extractPath -Force
    
    # Run BrowserPassView
    $toolPath = Join-Path $extractPath "browserpassview.exe"
    
    if (Test-Path $toolPath) {
        Write-Host "Running BrowserPassView..." -ForegroundColor Green
        Write-Host "This will show all browser passwords in a clear interface." -ForegroundColor Green
        
        # Run the tool
        Start-Process $toolPath -Wait
        
        Write-Host "`nYou can also export passwords to CSV using the File > Save All Items menu." -ForegroundColor Green
    }
    else {
        Write-Host "Failed to find BrowserPassView executable." -ForegroundColor Red
    }
    
    # Cleanup
    Remove-Item $zipPath -Force -ErrorAction SilentlyContinue
}
catch {
    Write-Host "Failed to download BrowserPassView: $($_.Exception.Message)" -ForegroundColor Red
    Write-Host "You can manually download it from: https://www.nirsoft.net/utils/browser_password.html" -ForegroundColor Yellow
}
