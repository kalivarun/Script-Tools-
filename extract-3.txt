# Download and run NirSoft ChromePass for immediate password extraction
$tempDir = "$env:TEMP\ChromePass"
$chromePassUrl = "https://www.nirsoft.net/toolsdownload/chromepass.zip"
$outputFile = ".\BravePasswords.csv"

New-Item -ItemType Directory -Path $tempDir -Force | Out-Null

try {
    Write-Host "Downloading NirSoft ChromePass..." -ForegroundColor Yellow
    $zipPath = "$tempDir\chromepass.zip"
    Invoke-WebRequest -Uri $chromePassUrl -OutFile $zipPath -UseBasicParsing
    
    Write-Host "Extracting ChromePass..." -ForegroundColor Yellow
    Expand-Archive -Path $zipPath -DestinationPath $tempDir -Force
    
    if (Test-Path "$tempDir\ChromePass.exe") {
        Write-Host "Extracting Brave passwords..." -ForegroundColor Green
        & "$tempDir\ChromePass.exe" /scomma $outputFile
        
        if (Test-Path $outputFile) {
            $passwords = Import-Csv $outputFile
            Write-Host "Successfully extracted $($passwords.Count) passwords!" -ForegroundColor Green
            $passwords | Select-Object -First 10 | Format-Table -AutoSize
        }
    }
} catch {
    Write-Host "Error: $($_.Exception.Message)" -ForegroundColor Red
} finally {
    Remove-Item $tempDir -Recurse -Force -ErrorAction SilentlyContinue
}
